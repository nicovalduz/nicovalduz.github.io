<html>
    <head>
        <title>Project Covid-19</title>
        <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.3.1/css/bootstrap.min.css">
        <script type="text/javascript" src="https://www.gstatic.com/charts/loader.js"></script>
        <script src="https://code.jquery.com/jquery-3.4.1.min.js"></script>
        <script type="text/javascript">
            //****************************************************** CURVE CHART ******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//            
            var dataCurveChart=[
                ['Day','Total Cases']
            ];

            function loadCurveChartData(data){
                for(var ir=0;ir<data.length;ir++){
                    dataCurveChart.push([
                        data[ir]['data'].substring(0,10),
                        parseInt(data[ir]['totale_casi'])
                    ]);                
                }
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-andamento-nazionale.json",function(data){
                loadCurveChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.load('current', {'packages':['corechart']});
            google.charts.setOnLoadCallback(drawCurveChart);

            function drawCurveChart(){
                var data = google.visualization.arrayToDataTable(dataCurveChart);

                var options={
                    title:'Covid-19 National Trend: Total Cases',
                    curveType:'function',
                    legend:{position:'bottom'}
                };

                var chart=new google.visualization.LineChart(document.getElementById('curve_chart'));
                chart.draw(data, options);
            }
            //*************************************************************************************************************************//
            
            //****************************************************** AREA CHART *******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//
            var dataAreaChart=[
                ['Day','New Positives']
            ];

            function loadAreaChartData(data){
                for(var ir=0;ir<data.length;ir++){
                    dataAreaChart.push([
                        data[ir]['data'].substring(0,10),
                        parseInt(data[ir]['nuovi_positivi'])
                    ]);                
                }
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-andamento-nazionale.json",function(data){
                loadAreaChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.setOnLoadCallback(drawAreaChart);

            function drawAreaChart(){
                var data=google.visualization.arrayToDataTable(dataAreaChart);

                var options={
                    title:'Covid-19 National Trend: New Daily Positives',
                    legend:{position:'bottom'}
                };

                var chart = new google.visualization.AreaChart(document.getElementById('area_chart'));
                chart.draw(data, options);
            }
            //*************************************************************************************************************************//
            
            //******************************************************* PIE CHART *******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//
            var dataPieChart=[
                ['Region','Total Cases']
            ];
			
            function loadPieChartData(data){
                for(var ir=0;ir<data.length;ir++){
                    dataPieChart.push([
                        data[ir]['denominazione_regione'],
                        parseInt(data[ir]['totale_casi'])
                    ]);                
                }
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-regioni-latest.json",function(data){
                loadPieChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.setOnLoadCallback(drawPieChart);
            
            function drawPieChart(){
        	var data=google.visualization.arrayToDataTable(dataPieChart);

                var options={
                    title:'Covid-19 Regional Trend: Total Cases'
                };

                var chart = new google.visualization.PieChart(document.getElementById('pie_chart'));
                chart.draw(data, options);
            }	
            //*************************************************************************************************************************//	
            
            //****************************************************** LINES CHART ******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//
            var dataLinesChart=[
                ['Day','Bologna','Modena']
            ];

            function loadLinesChartData(data){
                dataBologna=[];
                dataModena=[];
                //incapsulamento dati Provincia di Bologna
                for(var ir=0;ir<data.length;ir++){
                    if(data[ir]['denominazione_provincia']==='Bologna'){
                        dataBologna.push([
                            data[ir]['data'],
                            parseInt(data[ir]['totale_casi'])
                        ]);    
                    }            
                }
                //incapsulamento dati Provincia di Modena
                for(var ir=0;ir<data.length;ir++){
                    if(data[ir]['denominazione_provincia']==='Modena'){
                        dataModena.push([
                            parseInt(data[ir]['totale_casi'])
                        ]);    
                    }            
                }
                //incapsulamento dati nell'array generale
                for(var ir=0;ir<dataBologna.length;ir++){
                    dataLinesChart.push([
                        dataBologna[ir][0].substring(0,10),
                        parseInt(dataBologna[ir][1]),
                        parseInt(dataModena[ir][0])
                    ]);    
                }            
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-province.json",function(data){
                loadLinesChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.setOnLoadCallback(drawLinesChart);

            function drawLinesChart(){
                var data=google.visualization.arrayToDataTable(dataLinesChart);

                var options={
                    title:'Provincial Trend Covid-19 (Bologna/Modena): New Positives',
                    legend:{position:'bottom'}
                };

                var chart = new google.visualization.LineChart(document.getElementById('lines_chart'));
                chart.draw(data, options);
            }
            //*************************************************************************************************************************//
            
            //***************************************************** COLUMN CHART ******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//
            var dataColumnChart=[
                ['Period','Deaths',{ role: "style" }],
                ['Plague of 1600 (Manzoni\'s estimate)',1000000,'#cc3300'],
                ['First World War (Civilian Victims)',589000,'#ff9900'],
                ['Spanish Epidemic (1918-1920)',600000,'#ff0000'],
                ['World War II (Civilian Victims)',153147,'#ffcc00']
            ];
			
            function loadColumnChartData(data){
                dataColumnChart.push([
                    'Covid-19',
                    parseInt(data[0]['deceduti']),
                    '#e6e600'
                ]);   
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-andamento-nazionale-latest.json",function(data){
                loadColumnChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.setOnLoadCallback(drawColumnChart);
            
            function drawColumnChart(){
        	var data=google.visualization.arrayToDataTable(dataColumnChart);

                var options={
                    title:'Historical Comparison: Total Deaths in Italy',
                    legend:{position:'none'}
                };

                var chart = new google.visualization.ColumnChart(document.getElementById('column_chart'));
                chart.draw(data, options);
            }	
            //*************************************************************************************************************************//        
            
            //****************************************************** DONUT CHART ******************************************************//
            //---------------------------------- SEZIONE DI CARICAMENTO DATI DALLA REPOSITORY GitHub ----------------------------------//
            var dataDonutChart=[
                ['Provincie','Total Cases']
            ];
			
            function loadDonutChartData(data){
                for(var ir=0;ir<data.length;ir++){
                    dataDonutChart.push([
                        data[ir]['denominazione_provincia'],
                        parseInt(data[ir]['totale_casi'])
                    ]);                
                }  
            }

            $.getJSON("https://raw.githubusercontent.com/pcm-dpc/COVID-19/master/dati-json/dpc-covid19-ita-province-latest.json",function(data){
                loadDonutChartData(data);
            });
            //--------------------------------------------------- COSTRUZIONE GRAFICO -------------------------------------------------//
            google.charts.setOnLoadCallback(drawDonutChart);
            
            function drawDonutChart(){
        	var data=google.visualization.arrayToDataTable(dataDonutChart);

                var options={
                    title:'Provincial Trend Covid-19: Total Cases',
                    pieHole:0.4
                };

                var chart = new google.visualization.PieChart(document.getElementById('donut_chart'));
                chart.draw(data, options);
            }	
            //*************************************************************************************************************************//
        </script>
    </head>
    <body>
        <h1 style="font-family:arial;text-align:center;margin-top:40px;">Interdisciplinary Project - High School Diploma 2020<br>Valdiserri Nicol&ograve;</h1>
        <div class="row">
            <div style="width:50%;"><a href="pages/curveChart.html"><div id="curve_chart" style="height:500px"></div></a></div>
            <div style="width:50%;"><a href="pages/areaChart.html"><div id="area_chart" style="height:500px"></div></a></div>
            <div style="width:50%;"><a href="pages/pieChart.html"><div id="pie_chart" style="height:500px"></div></a></div>
            <div style="width:50%;"><a href="pages/linesChart.html"><div id="lines_chart" style="height:500px"></div></a></div>
            <div style="width:50%;"><a href="pages/columnChart.html"><div id="column_chart" style="height:500px"></div></a></div>
            <div style="width:50%;"><a href="pages/donutChart.html"><div id="donut_chart" style="height:500px"></div></a></div>
        </div> 
    </body>
</html>